/*
 * The MIT License
 *
 * Copyright 2017 Olivier.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
package UI;

import Instrument.Alteration;
import Instrument.Guitar;
import Instrument.Key;
import Instrument.KeyState;
import Instrument.Note;
import KeyUtils.RectangleKeyShape;
import KeyUtils.TriangleKeyShape;
import KeyUtils.Vector2;
import Manager.CanvasManagerDelegate;
import Manager.GaudrophoneController;
import Manager.GaudrophoneControllerDelegate;
import Manager.SelectionManagerDelegate;
import Manager.State;
import Music.Sound;
import Music.SoundType;
import Music.SynthesizedSound;
import Music.WaveFormType;
import java.awt.Color;
import java.awt.event.ActionEvent;
import java.awt.event.ComponentEvent;
import java.awt.event.ItemEvent;
import java.awt.event.KeyEvent;
import java.io.File;
import javax.swing.JColorChooser;
import javax.swing.JFileChooser;
import javax.swing.filechooser.FileFilter;
import javax.swing.filechooser.FileNameExtensionFilter;

public class Window extends javax.swing.JFrame implements GaudrophoneControllerDelegate, SelectionManagerDelegate, CanvasManagerDelegate {
    Canvas canvas = new Canvas(Manager.GaudrophoneController.getController().getCanvasManager());

    public Window() {
        initComponents();
        fileDialog.setCurrentDirectory(new File(System.getProperty("user.home")));
        noteProperties.setVisible(true);
        audioClipProperties.setVisible(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        bindingGroup = new org.jdesktop.beansbinding.BindingGroup();

        keyTypeButtonGroup = new javax.swing.ButtonGroup();
        alterationButtonGroup = new javax.swing.ButtonGroup();
        fileDialog = new javax.swing.JFileChooser();
        splitWindow = new javax.swing.JSplitPane();
        instrumentPanel = new javax.swing.JPanel();
        canvasPannel = new javax.swing.Box.Filler(new java.awt.Dimension(300, 100), new java.awt.Dimension(600, 600), new java.awt.Dimension(3000, 3000));
        rightScrollPane = new javax.swing.JScrollPane();
        tabbedPane = new javax.swing.JTabbedPane();
        visualPanel = new javax.swing.JPanel();
        visualWrapper = new javax.swing.JPanel();
        informationWrapper = new javax.swing.JPanel();
        informationTitle = new javax.swing.JLabel();
        keyNameProperty = new javax.swing.JPanel();
        keyNameLabel = new javax.swing.JLabel();
        keyNameField = new javax.swing.JTextField();
        showNameProperty = new javax.swing.JPanel();
        showNoteNameLabel = new javax.swing.JLabel();
        displayNameCheckBox = new javax.swing.JCheckBox();
        displayNoteCheckBox = new javax.swing.JCheckBox();
        filler6 = new javax.swing.Box.Filler(new java.awt.Dimension(20, 0), new java.awt.Dimension(20, 0), new java.awt.Dimension(20, 32767));
        displayOctaveCheckBox = new javax.swing.JCheckBox();
        displayAlterationCheckBox = new javax.swing.JCheckBox();
        colorsPanel = new javax.swing.JPanel();
        colorWrapper = new javax.swing.JPanel();
        colorTitle = new javax.swing.JLabel();
        normalWrapper = new javax.swing.JPanel();
        normalTitle = new javax.swing.JLabel();
        normalProperty = new javax.swing.JPanel();
        backgroundLabel = new javax.swing.JLabel();
        backgroundSpacer = new javax.swing.JPanel();
        filler2 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        backgroundDisplayLabel = new javax.swing.JLabel();
        filler3 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        textColorInfoLabel = new javax.swing.JLabel();
        textColorSpacer = new javax.swing.JPanel();
        filler10 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        textColorDisplayLabel = new javax.swing.JLabel();
        filler11 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        sunkenWrapper = new javax.swing.JPanel();
        sunkenTitle = new javax.swing.JLabel();
        sunkenProperty = new javax.swing.JPanel();
        backgroundSunkenLabel = new javax.swing.JLabel();
        sunkenSpacer = new javax.swing.JPanel();
        filler4 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        backgroundSunkenDisplayLabel = new javax.swing.JLabel();
        filler5 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        textSunkenColorLabel = new javax.swing.JLabel();
        textSunkenColorSpacer = new javax.swing.JPanel();
        filler12 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        textSunkenColorDisplayLabel = new javax.swing.JLabel();
        filler13 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        borderPanel = new javax.swing.JPanel();
        linesWrapper = new javax.swing.JPanel();
        borderWrapper = new javax.swing.JPanel();
        borderTitle = new javax.swing.JLabel();
        linesSelectionWrapper = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jComboBox1 = new javax.swing.JComboBox<>();
        lineControlWrapper = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jSpinner1 = new javax.swing.JSpinner();
        jPanel2 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        borderSpacer1 = new javax.swing.JPanel();
        filler14 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        outlineDisplayLabel1 = new javax.swing.JLabel();
        filler15 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 0), new java.awt.Dimension(10, 32767));
        audioPanel = new javax.swing.JPanel();
        KeyProperties = new javax.swing.JPanel();
        generalProperties = new javax.swing.JPanel();
        hauteurTitlePanel = new javax.swing.JPanel();
        hauteurTitle = new javax.swing.JLabel();
        noteNameProperty = new javax.swing.JPanel();
        noteNameLabel = new javax.swing.JLabel();
        noteComboBox = new javax.swing.JComboBox(Note.values());
        octaveLabel = new javax.swing.JLabel();
        octaveSpinner = new javax.swing.JSpinner();
        alterationProperty = new javax.swing.JPanel();
        alterationLabel = new javax.swing.JLabel();
        flatRadioButton = new javax.swing.JRadioButton();
        naturalRadioButton = new javax.swing.JRadioButton();
        sharpRadioButton = new javax.swing.JRadioButton();
        envelopeProperties = new javax.swing.JPanel();
        envelopeTitlePanel = new javax.swing.JPanel();
        envelopeLabel = new javax.swing.JLabel();
        volumeProperty = new javax.swing.JPanel();
        volumeLabel = new javax.swing.JLabel();
        volumeSlider = new javax.swing.JSlider();
        volumeSpinner = new javax.swing.JSpinner();
        envelopeGraph = new javax.swing.JPanel();
        envelopeSliders = new javax.swing.JPanel();
        attackSliderPanel = new javax.swing.JPanel();
        attackSlider = new javax.swing.JSlider();
        attackSpinner = new javax.swing.JSpinner();
        attackLabel = new javax.swing.JLabel();
        decaySliderPanel = new javax.swing.JPanel();
        decaySlider = new javax.swing.JSlider();
        decaySpinner = new javax.swing.JSpinner();
        decayLabel = new javax.swing.JLabel();
        sustainSliderPanel = new javax.swing.JPanel();
        sustainSlider = new javax.swing.JSlider();
        sustainSpinner = new javax.swing.JSpinner();
        sustainLabel = new javax.swing.JLabel();
        releaseSliderPanel = new javax.swing.JPanel();
        releaseSlider = new javax.swing.JSlider();
        releaseSpinner = new javax.swing.JSpinner();
        releaseLabel = new javax.swing.JLabel();
        timbreTitlePanel = new javax.swing.JPanel();
        timbreTitle = new javax.swing.JLabel();
        typeProperty = new javax.swing.JPanel();
        synthRadioButton = new javax.swing.JRadioButton();
        audioClipRadioButton = new javax.swing.JRadioButton();
        noteProperties = new javax.swing.JPanel();
        frequencyProperty = new javax.swing.JPanel();
        frequencyLabel = new javax.swing.JLabel();
        frequencySpinner = new javax.swing.JSpinner();
        tuningProperty = new javax.swing.JPanel();
        tuningLabel = new javax.swing.JLabel();
        tuningSpinner = new javax.swing.JSpinner();
        waveFormProperty = new javax.swing.JPanel();
        waveFormLabel = new javax.swing.JLabel();
        waveformComboBox = new javax.swing.JComboBox(WaveFormType.values());
        audioClipProperties = new javax.swing.JPanel();
        audioClipFileProperty = new javax.swing.JPanel();
        audioClipFileLabel = new javax.swing.JLabel();
        audioClipPathLabel = new javax.swing.JLabel();
        audioClipSelectButton = new java.awt.Button();
        readSpeedProperty = new javax.swing.JPanel();
        readSpeedLabel = new javax.swing.JLabel();
        readSpeedSpinner = new javax.swing.JSpinner();
        jToolBar1 = new javax.swing.JToolBar();
        buttonPlayMode = new javax.swing.JButton();
        buttonEditKey = new javax.swing.JButton();
        filler7 = new javax.swing.Box.Filler(new java.awt.Dimension(40, 0), new java.awt.Dimension(40, 0), new java.awt.Dimension(40, 32767));
        selectedKeyTools = new javax.swing.JPanel();
        buttonDuplicate = new javax.swing.JButton();
        buttonAddImage = new javax.swing.JButton();
        buttonRemoveImage = new javax.swing.JButton();
        buttonAddSunkenImage = new javax.swing.JButton();
        buttonRemoveSunkenImage = new javax.swing.JButton();
        buttonDelete = new javax.swing.JButton();
        jMenuBar1 = new javax.swing.JMenuBar();
        fileMenuItem = new javax.swing.JMenu();
        newMenu = new javax.swing.JMenu();
        newBlankMenuItem = new javax.swing.JMenuItem();
        newGuitarMenuItem = new javax.swing.JMenuItem();
        openMenuItem = new javax.swing.JMenuItem();
        saveMenuItem = new javax.swing.JMenuItem();
        saveAsMenuItem = new javax.swing.JMenuItem();
        quitMenuItem = new javax.swing.JMenuItem();
        insertMenuItem = new javax.swing.JMenu();
        createRectangleMenuItem = new javax.swing.JMenuItem();
        createTriangleMenuItem = new javax.swing.JMenuItem();

        fileDialog.setCurrentDirectory(new java.io.File("/"));

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Gaudrophone");
        setBackground(new java.awt.Color(65, 65, 65));
        setLocation(new java.awt.Point(100, 100));
        setMinimumSize(new java.awt.Dimension(500, 300));
        setPreferredSize(new java.awt.Dimension(959, 760));

        splitWindow.setBackground(new java.awt.Color(51, 51, 51));
        splitWindow.setBorder(null);
        splitWindow.setDividerLocation(300);
        splitWindow.setContinuousLayout(true);
        splitWindow.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        splitWindow.setPreferredSize(new java.awt.Dimension(959, 700));

        instrumentPanel.setBackground(new java.awt.Color(102, 102, 102));
        instrumentPanel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(51, 51, 51), 4));
        instrumentPanel.setLayout(new java.awt.BorderLayout());
        instrumentPanel.add(canvasPannel, java.awt.BorderLayout.CENTER);

        splitWindow.setLeftComponent(instrumentPanel);

        rightScrollPane.setBackground(new java.awt.Color(65, 65, 65));
        rightScrollPane.setBorder(null);
        rightScrollPane.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        rightScrollPane.setAutoscrolls(true);
        rightScrollPane.setMinimumSize(new java.awt.Dimension(415, 200));
        rightScrollPane.setPreferredSize(new java.awt.Dimension(415, 200));
        rightScrollPane.setViewportView(tabbedPane);

        tabbedPane.setBackground(new java.awt.Color(65, 65, 65));
        tabbedPane.setForeground(new java.awt.Color(255, 255, 255));
        tabbedPane.setTabLayoutPolicy(javax.swing.JTabbedPane.SCROLL_TAB_LAYOUT);
        tabbedPane.setMinimumSize(new java.awt.Dimension(400, 100));
        tabbedPane.setOpaque(true);
        tabbedPane.setPreferredSize(new java.awt.Dimension(400, 670));

        visualPanel.setBackground(new java.awt.Color(65, 65, 65));
        visualPanel.setMinimumSize(new java.awt.Dimension(600, 655));
        visualPanel.setPreferredSize(new java.awt.Dimension(50, 200));
        visualPanel.setLayout(new javax.swing.BoxLayout(visualPanel, javax.swing.BoxLayout.LINE_AXIS));

        visualWrapper.setBackground(new java.awt.Color(65, 65, 65));
        visualWrapper.setLayout(new javax.swing.BoxLayout(visualWrapper, javax.swing.BoxLayout.Y_AXIS));

        informationWrapper.setBackground(new java.awt.Color(65, 65, 65));
        informationWrapper.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        informationWrapper.setPreferredSize(new java.awt.Dimension(50, 20));
        informationWrapper.setLayout(new java.awt.GridLayout());

        informationTitle.setFont(new java.awt.Font("Lucida Grande", 1, 18)); // NOI18N
        informationTitle.setForeground(new java.awt.Color(255, 255, 255));
        informationTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        informationTitle.setText("Général");
        informationTitle.setToolTipText("");
        informationTitle.setPreferredSize(new java.awt.Dimension(72, 20));
        informationWrapper.add(informationTitle);

        visualWrapper.add(informationWrapper);

        keyNameProperty.setBackground(new java.awt.Color(65, 65, 65));
        keyNameProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        keyNameProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        keyNameProperty.setPreferredSize(new java.awt.Dimension(375, 0));
        keyNameProperty.setLayout(new java.awt.GridLayout(1, 0));

        keyNameLabel.setForeground(new java.awt.Color(255, 255, 255));
        keyNameLabel.setText("Nom de la touche :");
        keyNameLabel.setMinimumSize(new java.awt.Dimension(40, 16));
        keyNameLabel.setPreferredSize(new java.awt.Dimension(0, 0));
        keyNameProperty.add(keyNameLabel);

        keyNameField.setBackground(new java.awt.Color(238, 238, 238));
        keyNameField.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        keyNameField.setText("Nom de la touche");
        keyNameField.setBorder(null);
        keyNameField.setMinimumSize(new java.awt.Dimension(30, 26));
        keyNameField.setPreferredSize(new java.awt.Dimension(0, 0));
        keyNameField.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                keyNameFieldKeyReleased(evt);
            }
        });
        keyNameProperty.add(keyNameField);

        visualWrapper.add(keyNameProperty);

        showNameProperty.setBackground(new java.awt.Color(65, 65, 65));
        showNameProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        showNameProperty.setForeground(new java.awt.Color(255, 255, 255));
        showNameProperty.setMinimumSize(new java.awt.Dimension(128, 100));
        showNameProperty.setPreferredSize(new java.awt.Dimension(375, 40));
        showNameProperty.setLayout(new java.awt.GridLayout(2, 0));

        showNoteNameLabel.setBackground(new java.awt.Color(65, 65, 65));
        showNoteNameLabel.setForeground(new java.awt.Color(255, 255, 255));
        showNoteNameLabel.setText("Affichage :");
        showNoteNameLabel.setToolTipText("");
        showNoteNameLabel.setMinimumSize(new java.awt.Dimension(40, 16));
        showNoteNameLabel.setOpaque(true);
        showNoteNameLabel.setPreferredSize(new java.awt.Dimension(40, 26));
        showNoteNameLabel.setSize(new java.awt.Dimension(40, 26));
        showNameProperty.add(showNoteNameLabel);

        displayNameCheckBox.setBackground(new java.awt.Color(65, 65, 65));
        displayNameCheckBox.setForeground(new java.awt.Color(255, 255, 255));
        displayNameCheckBox.setSelected(true);
        displayNameCheckBox.setText("Nom");
        displayNameCheckBox.setMinimumSize(new java.awt.Dimension(40, 26));
        displayNameCheckBox.setPreferredSize(new java.awt.Dimension(40, 26));
        displayNameCheckBox.setSize(new java.awt.Dimension(40, 26));
        displayNameCheckBox.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                displayNameCheckBoxItemStateChanged(evt);
            }
        });
        showNameProperty.add(displayNameCheckBox);

        displayNoteCheckBox.setBackground(new java.awt.Color(65, 65, 65));
        displayNoteCheckBox.setForeground(new java.awt.Color(255, 255, 255));
        displayNoteCheckBox.setSelected(true);
        displayNoteCheckBox.setText("Note");
        displayNoteCheckBox.setMinimumSize(new java.awt.Dimension(40, 26));
        displayNoteCheckBox.setPreferredSize(new java.awt.Dimension(40, 26));
        displayNoteCheckBox.setSize(new java.awt.Dimension(40, 26));
        displayNoteCheckBox.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                displayNoteCheckBoxItemStateChanged(evt);
            }
        });
        showNameProperty.add(displayNoteCheckBox);

        filler6.setSize(new java.awt.Dimension(40, 26));
        showNameProperty.add(filler6);

        displayOctaveCheckBox.setBackground(new java.awt.Color(65, 65, 65));
        displayOctaveCheckBox.setForeground(new java.awt.Color(255, 255, 255));
        displayOctaveCheckBox.setSelected(true);
        displayOctaveCheckBox.setText("Octave");
        displayOctaveCheckBox.setMinimumSize(new java.awt.Dimension(40, 26));
        displayOctaveCheckBox.setPreferredSize(new java.awt.Dimension(40, 26));
        displayOctaveCheckBox.setSize(new java.awt.Dimension(40, 26));
        displayOctaveCheckBox.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                displayOctaveCheckBoxItemStateChanged(evt);
            }
        });
        showNameProperty.add(displayOctaveCheckBox);

        displayAlterationCheckBox.setBackground(new java.awt.Color(65, 65, 65));
        displayAlterationCheckBox.setForeground(new java.awt.Color(255, 255, 255));
        displayAlterationCheckBox.setText("Altération");
        displayAlterationCheckBox.setMinimumSize(new java.awt.Dimension(40, 26));
        displayAlterationCheckBox.setPreferredSize(new java.awt.Dimension(40, 26));
        displayAlterationCheckBox.setSize(new java.awt.Dimension(40, 26));
        displayAlterationCheckBox.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                displayAlterationCheckBoxItemStateChanged(evt);
            }
        });
        showNameProperty.add(displayAlterationCheckBox);

        visualWrapper.add(showNameProperty);

        colorsPanel.setBackground(new java.awt.Color(65, 65, 65));
        colorsPanel.setPreferredSize(new java.awt.Dimension(0, 0));
        colorsPanel.setLayout(new javax.swing.BoxLayout(colorsPanel, javax.swing.BoxLayout.PAGE_AXIS));

        colorWrapper.setBackground(new java.awt.Color(65, 65, 65));
        colorWrapper.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        colorWrapper.setPreferredSize(new java.awt.Dimension(50, 20));
        colorWrapper.setLayout(new java.awt.GridLayout());

        colorTitle.setFont(new java.awt.Font("Lucida Grande", 1, 18)); // NOI18N
        colorTitle.setForeground(new java.awt.Color(255, 255, 255));
        colorTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        colorTitle.setText("Couleur");
        colorTitle.setToolTipText("");
        colorTitle.setPreferredSize(new java.awt.Dimension(72, 0));
        colorWrapper.add(colorTitle);

        colorsPanel.add(colorWrapper);

        normalWrapper.setBackground(new java.awt.Color(65, 65, 65));
        normalWrapper.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        normalWrapper.setPreferredSize(new java.awt.Dimension(50, 0));
        normalWrapper.setLayout(new java.awt.GridLayout());

        normalTitle.setFont(new java.awt.Font("Lucida Grande", 1, 14)); // NOI18N
        normalTitle.setForeground(new java.awt.Color(255, 255, 255));
        normalTitle.setText("Normal");
        normalTitle.setToolTipText("");
        normalTitle.setPreferredSize(new java.awt.Dimension(72, 0));
        normalWrapper.add(normalTitle);

        colorsPanel.add(normalWrapper);

        normalProperty.setBackground(new java.awt.Color(65, 65, 65));
        normalProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        normalProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        normalProperty.setPreferredSize(new java.awt.Dimension(0, 0));
        normalProperty.setLayout(new java.awt.GridLayout(1, 10, 10, 0));

        backgroundLabel.setBackground(new java.awt.Color(65, 65, 65));
        backgroundLabel.setForeground(new java.awt.Color(255, 255, 255));
        backgroundLabel.setText("Arrière-plan :");
        backgroundLabel.setOpaque(true);
        normalProperty.add(backgroundLabel);

        backgroundSpacer.setBackground(new java.awt.Color(65, 65, 65));
        backgroundSpacer.setLayout(new java.awt.GridLayout(1, 0));

        filler2.setBackground(new java.awt.Color(65, 65, 65));
        backgroundSpacer.add(filler2);

        backgroundDisplayLabel.setBackground(new java.awt.Color(65, 65, 65));
        backgroundDisplayLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        backgroundDisplayLabel.setToolTipText("");
        backgroundDisplayLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(102, 102, 102)));
        backgroundDisplayLabel.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        backgroundDisplayLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        backgroundDisplayLabel.setOpaque(true);
        backgroundDisplayLabel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                backgroundDisplayLabelMouseClicked(evt);
            }
        });
        backgroundSpacer.add(backgroundDisplayLabel);

        filler3.setBackground(new java.awt.Color(65, 65, 65));
        backgroundSpacer.add(filler3);

        normalProperty.add(backgroundSpacer);

        textColorInfoLabel.setBackground(new java.awt.Color(65, 65, 65));
        textColorInfoLabel.setForeground(new java.awt.Color(255, 255, 255));
        textColorInfoLabel.setText("Texte :");
        textColorInfoLabel.setOpaque(true);
        normalProperty.add(textColorInfoLabel);

        textColorSpacer.setBackground(new java.awt.Color(65, 65, 65));
        textColorSpacer.setLayout(new java.awt.GridLayout(1, 0));

        filler10.setBackground(new java.awt.Color(65, 65, 65));
        textColorSpacer.add(filler10);

        textColorDisplayLabel.setBackground(new java.awt.Color(65, 65, 65));
        textColorDisplayLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        textColorDisplayLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(102, 102, 102)));
        textColorDisplayLabel.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        textColorDisplayLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        textColorDisplayLabel.setOpaque(true);
        textColorDisplayLabel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                textColorDisplayLabelMouseClicked(evt);
            }
        });
        textColorSpacer.add(textColorDisplayLabel);

        filler11.setBackground(new java.awt.Color(65, 65, 65));
        textColorSpacer.add(filler11);

        normalProperty.add(textColorSpacer);

        colorsPanel.add(normalProperty);

        sunkenWrapper.setBackground(new java.awt.Color(65, 65, 65));
        sunkenWrapper.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        sunkenWrapper.setPreferredSize(new java.awt.Dimension(50, 0));
        sunkenWrapper.setLayout(new java.awt.GridLayout());

        sunkenTitle.setFont(new java.awt.Font("Lucida Grande", 1, 14)); // NOI18N
        sunkenTitle.setForeground(new java.awt.Color(255, 255, 255));
        sunkenTitle.setText("Enfoncé");
        sunkenTitle.setToolTipText("");
        sunkenTitle.setPreferredSize(new java.awt.Dimension(72, 0));
        sunkenWrapper.add(sunkenTitle);

        colorsPanel.add(sunkenWrapper);

        sunkenProperty.setBackground(new java.awt.Color(65, 65, 65));
        sunkenProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        sunkenProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        sunkenProperty.setPreferredSize(new java.awt.Dimension(0, 0));
        sunkenProperty.setLayout(new java.awt.GridLayout(1, 0, 10, 0));

        backgroundSunkenLabel.setBackground(new java.awt.Color(65, 65, 65));
        backgroundSunkenLabel.setForeground(new java.awt.Color(255, 255, 255));
        backgroundSunkenLabel.setText("Arrière-plan");
        backgroundSunkenLabel.setOpaque(true);
        sunkenProperty.add(backgroundSunkenLabel);

        sunkenSpacer.setBackground(new java.awt.Color(65, 65, 65));
        sunkenSpacer.setLayout(new java.awt.GridLayout(1, 0));

        filler4.setBackground(new java.awt.Color(65, 65, 65));
        sunkenSpacer.add(filler4);

        backgroundSunkenDisplayLabel.setBackground(new java.awt.Color(65, 65, 65));
        backgroundSunkenDisplayLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        backgroundSunkenDisplayLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(102, 102, 102)));
        backgroundSunkenDisplayLabel.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        backgroundSunkenDisplayLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        backgroundSunkenDisplayLabel.setOpaque(true);
        backgroundSunkenDisplayLabel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                backgroundSunkenDisplayLabelMouseClicked(evt);
            }
        });
        sunkenSpacer.add(backgroundSunkenDisplayLabel);

        filler5.setBackground(new java.awt.Color(65, 65, 65));
        sunkenSpacer.add(filler5);

        sunkenProperty.add(sunkenSpacer);

        textSunkenColorLabel.setBackground(new java.awt.Color(65, 65, 65));
        textSunkenColorLabel.setForeground(new java.awt.Color(255, 255, 255));
        textSunkenColorLabel.setText("Texte");
        textSunkenColorLabel.setOpaque(true);
        sunkenProperty.add(textSunkenColorLabel);

        textSunkenColorSpacer.setBackground(new java.awt.Color(65, 65, 65));
        textSunkenColorSpacer.setLayout(new java.awt.GridLayout(1, 0));

        filler12.setBackground(new java.awt.Color(65, 65, 65));
        textSunkenColorSpacer.add(filler12);

        textSunkenColorDisplayLabel.setBackground(new java.awt.Color(65, 65, 65));
        textSunkenColorDisplayLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        textSunkenColorDisplayLabel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(102, 102, 102)));
        textSunkenColorDisplayLabel.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        textSunkenColorDisplayLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        textSunkenColorDisplayLabel.setOpaque(true);
        textSunkenColorDisplayLabel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                textSunkenColorDisplayLabelMouseClicked(evt);
            }
        });
        textSunkenColorSpacer.add(textSunkenColorDisplayLabel);

        filler13.setBackground(new java.awt.Color(65, 65, 65));
        textSunkenColorSpacer.add(filler13);

        sunkenProperty.add(textSunkenColorSpacer);

        colorsPanel.add(sunkenProperty);

        visualWrapper.add(colorsPanel);

        borderPanel.setBackground(new java.awt.Color(65, 65, 65));
        borderPanel.setLayout(new javax.swing.BoxLayout(borderPanel, javax.swing.BoxLayout.LINE_AXIS));

        linesWrapper.setBackground(new java.awt.Color(65, 65, 65));
        linesWrapper.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        linesWrapper.setLayout(new javax.swing.BoxLayout(linesWrapper, javax.swing.BoxLayout.PAGE_AXIS));

        borderWrapper.setBackground(new java.awt.Color(65, 65, 65));
        borderWrapper.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        borderWrapper.setPreferredSize(new java.awt.Dimension(50, 20));
        borderWrapper.setLayout(new java.awt.GridLayout());

        borderTitle.setFont(new java.awt.Font("Lucida Grande", 1, 18)); // NOI18N
        borderTitle.setForeground(new java.awt.Color(255, 255, 255));
        borderTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        borderTitle.setText("Bordures");
        borderTitle.setToolTipText("");
        borderTitle.setPreferredSize(new java.awt.Dimension(72, 0));
        borderWrapper.add(borderTitle);

        linesWrapper.add(borderWrapper);

        linesSelectionWrapper.setBackground(new java.awt.Color(65, 65, 65));
        linesSelectionWrapper.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        linesSelectionWrapper.setMinimumSize(new java.awt.Dimension(0, 0));
        linesSelectionWrapper.setPreferredSize(new java.awt.Dimension(0, 0));
        java.awt.FlowLayout flowLayout1 = new java.awt.FlowLayout(java.awt.FlowLayout.CENTER, 0, 0);
        flowLayout1.setAlignOnBaseline(true);
        linesSelectionWrapper.setLayout(flowLayout1);

        jLabel1.setBackground(new java.awt.Color(65, 65, 65));
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("Sélection de ligne :");
        jLabel1.setPreferredSize(new java.awt.Dimension(150, 16));
        linesSelectionWrapper.add(jLabel1);

        jComboBox1.setBackground(new java.awt.Color(65, 65, 65));
        jComboBox1.setMinimumSize(new java.awt.Dimension(100, 27));
        jComboBox1.setPreferredSize(new java.awt.Dimension(200, 27));
        linesSelectionWrapper.add(jComboBox1);

        linesWrapper.add(linesSelectionWrapper);

        lineControlWrapper.setBackground(new java.awt.Color(65, 65, 65));
        lineControlWrapper.setLayout(new javax.swing.BoxLayout(lineControlWrapper, javax.swing.BoxLayout.PAGE_AXIS));

        jPanel1.setBackground(new java.awt.Color(65, 65, 65));
        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        jPanel1.setPreferredSize(new java.awt.Dimension(0, 0));
        jPanel1.setLayout(new java.awt.GridLayout());

        jLabel2.setBackground(new java.awt.Color(65, 65, 65));
        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setText("Épaisseur :");
        jPanel1.add(jLabel2);
        jPanel1.add(jSpinner1);

        lineControlWrapper.add(jPanel1);

        jPanel2.setBackground(new java.awt.Color(65, 65, 65));
        jPanel2.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        jPanel2.setPreferredSize(new java.awt.Dimension(0, 0));
        jPanel2.setLayout(new java.awt.GridLayout());

        jLabel3.setBackground(new java.awt.Color(65, 65, 65));
        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("Couleur :");
        jPanel2.add(jLabel3);

        borderSpacer1.setBackground(new java.awt.Color(65, 65, 65));
        borderSpacer1.setLayout(new java.awt.GridLayout());

        filler14.setBackground(new java.awt.Color(65, 65, 65));
        borderSpacer1.add(filler14);

        outlineDisplayLabel1.setBackground(new java.awt.Color(65, 65, 65));
        outlineDisplayLabel1.setForeground(new java.awt.Color(255, 255, 255));
        outlineDisplayLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        outlineDisplayLabel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(102, 102, 102)));
        outlineDisplayLabel1.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        outlineDisplayLabel1.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        outlineDisplayLabel1.setOpaque(true);
        outlineDisplayLabel1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                outlineDisplayLabel1MouseClicked(evt);
            }
        });
        borderSpacer1.add(outlineDisplayLabel1);

        filler15.setBackground(new java.awt.Color(65, 65, 65));
        borderSpacer1.add(filler15);

        jPanel2.add(borderSpacer1);

        lineControlWrapper.add(jPanel2);

        linesWrapper.add(lineControlWrapper);

        borderPanel.add(linesWrapper);

        visualWrapper.add(borderPanel);

        visualPanel.add(visualWrapper);

        tabbedPane.addTab("Visuel", visualPanel);

        audioPanel.setBackground(new java.awt.Color(65, 65, 65));
        audioPanel.setMinimumSize(new java.awt.Dimension(50, 200));
        audioPanel.setPreferredSize(new java.awt.Dimension(50, 200));
        audioPanel.setLayout(new javax.swing.BoxLayout(audioPanel, javax.swing.BoxLayout.LINE_AXIS));

        KeyProperties.setBackground(new java.awt.Color(65, 65, 65));
        KeyProperties.setAlignmentX(0.5F);
        KeyProperties.setMinimumSize(new java.awt.Dimension(300, 200));
        KeyProperties.setPreferredSize(new java.awt.Dimension(415, 200));
        KeyProperties.setLayout(new javax.swing.BoxLayout(KeyProperties, javax.swing.BoxLayout.Y_AXIS));

        generalProperties.setBackground(new java.awt.Color(65, 65, 65));
        generalProperties.setMinimumSize(new java.awt.Dimension(50, 200));
        generalProperties.setPreferredSize(new java.awt.Dimension(50, 200));
        generalProperties.setLayout(new javax.swing.BoxLayout(generalProperties, javax.swing.BoxLayout.Y_AXIS));

        hauteurTitlePanel.setBackground(new java.awt.Color(65, 65, 65));
        hauteurTitlePanel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        hauteurTitlePanel.setPreferredSize(new java.awt.Dimension(50, 46));
        hauteurTitlePanel.setLayout(new java.awt.GridLayout());

        hauteurTitle.setFont(new java.awt.Font("Lucida Grande", 1, 18)); // NOI18N
        hauteurTitle.setForeground(new java.awt.Color(255, 255, 255));
        hauteurTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        hauteurTitle.setText("Hauteur");
        hauteurTitle.setToolTipText("");
        hauteurTitle.setPreferredSize(new java.awt.Dimension(72, 26));
        hauteurTitlePanel.add(hauteurTitle);

        generalProperties.add(hauteurTitlePanel);

        noteNameProperty.setBackground(new java.awt.Color(65, 65, 65));
        noteNameProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        noteNameProperty.setForeground(new java.awt.Color(255, 255, 255));
        noteNameProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        noteNameProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        noteNameProperty.setLayout(new java.awt.GridLayout());

        noteNameLabel.setBackground(new java.awt.Color(65, 65, 65));
        noteNameLabel.setForeground(new java.awt.Color(255, 255, 255));
        noteNameLabel.setText("Note :");
        noteNameProperty.add(noteNameLabel);

        noteComboBox.setMinimumSize(new java.awt.Dimension(30, 26));
        noteNameProperty.add(noteComboBox);

        octaveLabel.setForeground(new java.awt.Color(255, 255, 255));
        octaveLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        octaveLabel.setText("Octave :");
        noteNameProperty.add(octaveLabel);

        octaveSpinner.setModel(new javax.swing.SpinnerNumberModel(4, 0, 8, 1));
        octaveSpinner.setMinimumSize(new java.awt.Dimension(30, 26));
        octaveSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                octaveSpinnerStateChanged(evt);
            }
        });
        noteNameProperty.add(octaveSpinner);

        generalProperties.add(noteNameProperty);

        alterationProperty.setBackground(new java.awt.Color(65, 65, 65));
        alterationProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        alterationProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        alterationProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        alterationProperty.setLayout(new java.awt.GridLayout(1, 0));

        alterationLabel.setBackground(new java.awt.Color(65, 65, 65));
        alterationLabel.setForeground(new java.awt.Color(255, 255, 255));
        alterationLabel.setText("Altération :");
        alterationProperty.add(alterationLabel);

        flatRadioButton.setBackground(new java.awt.Color(65, 65, 65));
        alterationButtonGroup.add(flatRadioButton);
        flatRadioButton.setForeground(new java.awt.Color(255, 255, 255));
        flatRadioButton.setText("Bémol");
        flatRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                flatRadioButtonActionPerformed(evt);
            }
        });
        alterationProperty.add(flatRadioButton);

        naturalRadioButton.setBackground(new java.awt.Color(65, 65, 65));
        alterationButtonGroup.add(naturalRadioButton);
        naturalRadioButton.setForeground(new java.awt.Color(255, 255, 255));
        naturalRadioButton.setSelected(true);
        naturalRadioButton.setText("Naturelle");
        naturalRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                naturalRadioButtonActionPerformed(evt);
            }
        });
        alterationProperty.add(naturalRadioButton);

        sharpRadioButton.setBackground(new java.awt.Color(65, 65, 65));
        alterationButtonGroup.add(sharpRadioButton);
        sharpRadioButton.setForeground(new java.awt.Color(255, 255, 255));
        sharpRadioButton.setText("Dièse");
        sharpRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sharpRadioButtonActionPerformed(evt);
            }
        });
        alterationProperty.add(sharpRadioButton);

        generalProperties.add(alterationProperty);

        envelopeProperties.setBackground(new java.awt.Color(65, 65, 65));
        envelopeProperties.setPreferredSize(new java.awt.Dimension(50, 399));
        envelopeProperties.setLayout(new javax.swing.BoxLayout(envelopeProperties, javax.swing.BoxLayout.Y_AXIS));

        envelopeTitlePanel.setBackground(new java.awt.Color(65, 65, 65));
        envelopeTitlePanel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        envelopeTitlePanel.setPreferredSize(new java.awt.Dimension(50, 46));
        envelopeTitlePanel.setLayout(new java.awt.GridLayout(1, 0));

        envelopeLabel.setFont(new java.awt.Font("Lucida Grande", 1, 18)); // NOI18N
        envelopeLabel.setForeground(new java.awt.Color(255, 255, 255));
        envelopeLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        envelopeLabel.setText("Enveloppe");
        envelopeLabel.setToolTipText("");
        envelopeLabel.setMaximumSize(new java.awt.Dimension(117, 100));
        envelopeLabel.setPreferredSize(new java.awt.Dimension(72, 150));
        envelopeTitlePanel.add(envelopeLabel);

        envelopeProperties.add(envelopeTitlePanel);

        volumeProperty.setBackground(new java.awt.Color(65, 65, 65));
        volumeProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        volumeProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        volumeProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        volumeProperty.setLayout(new java.awt.GridLayout(1, 4));

        volumeLabel.setBackground(new java.awt.Color(65, 65, 65));
        volumeLabel.setForeground(new java.awt.Color(255, 255, 255));
        volumeLabel.setText("Volume :");
        volumeLabel.setOpaque(true);
        volumeProperty.add(volumeLabel);

        volumeSlider.setBackground(new java.awt.Color(65, 65, 65));
        volumeSlider.setForeground(new java.awt.Color(255, 255, 255));
        volumeSlider.setMinimumSize(new java.awt.Dimension(100, 29));
        volumeSlider.setPreferredSize(new java.awt.Dimension(400, 29));

        org.jdesktop.beansbinding.Binding binding = org.jdesktop.beansbinding.Bindings.createAutoBinding(org.jdesktop.beansbinding.AutoBinding.UpdateStrategy.READ_WRITE, volumeSpinner, org.jdesktop.beansbinding.ELProperty.create("${value}"), volumeSlider, org.jdesktop.beansbinding.BeanProperty.create("value"));
        bindingGroup.addBinding(binding);

        volumeSlider.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                volumeSliderStateChanged(evt);
            }
        });
        volumeProperty.add(volumeSlider);

        volumeSpinner.setModel(new javax.swing.SpinnerNumberModel(100, 0, 100, 1));
        volumeSpinner.setMinimumSize(new java.awt.Dimension(100, 26));
        volumeSpinner.setPreferredSize(new java.awt.Dimension(150, 26));
        volumeSpinner.setValue(100);
        volumeProperty.add(volumeSpinner);

        envelopeProperties.add(volumeProperty);

        envelopeGraph.setBackground(new java.awt.Color(51, 51, 51));
        envelopeGraph.setMinimumSize(new java.awt.Dimension(50, 100));
        envelopeGraph.setPreferredSize(new java.awt.Dimension(50, 125));

        javax.swing.GroupLayout envelopeGraphLayout = new javax.swing.GroupLayout(envelopeGraph);
        envelopeGraph.setLayout(envelopeGraphLayout);
        envelopeGraphLayout.setHorizontalGroup(
            envelopeGraphLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 594, Short.MAX_VALUE)
        );
        envelopeGraphLayout.setVerticalGroup(
            envelopeGraphLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 107, Short.MAX_VALUE)
        );

        envelopeProperties.add(envelopeGraph);

        envelopeSliders.setBackground(new java.awt.Color(65, 65, 65));
        envelopeSliders.setPreferredSize(new java.awt.Dimension(50, 242));
        envelopeSliders.setLayout(new javax.swing.BoxLayout(envelopeSliders, javax.swing.BoxLayout.X_AXIS));

        attackSliderPanel.setBackground(new java.awt.Color(65, 65, 65));
        attackSliderPanel.setLayout(new java.awt.BorderLayout());

        attackSlider.setBackground(new java.awt.Color(65, 65, 65));
        attackSlider.setForeground(new java.awt.Color(255, 255, 255));
        attackSlider.setMaximum(5000);
        attackSlider.setOrientation(javax.swing.JSlider.VERTICAL);
        attackSlider.setMaximumSize(new java.awt.Dimension(50, 32767));
        attackSlider.setMinimumSize(new java.awt.Dimension(20, 50));
        attackSlider.setPreferredSize(new java.awt.Dimension(50, 200));

        binding = org.jdesktop.beansbinding.Bindings.createAutoBinding(org.jdesktop.beansbinding.AutoBinding.UpdateStrategy.READ_WRITE, attackSpinner, org.jdesktop.beansbinding.ELProperty.create("${value}"), attackSlider, org.jdesktop.beansbinding.BeanProperty.create("value"));
        bindingGroup.addBinding(binding);

        attackSliderPanel.add(attackSlider, java.awt.BorderLayout.CENTER);
        attackSlider.setBackground(new Color(65, 65, 65));

        attackSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, 5000, 1));
        attackSpinner.setMinimumSize(new java.awt.Dimension(20, 26));
        attackSpinner.setPreferredSize(new java.awt.Dimension(20, 26));
        attackSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                attackSpinnerStateChanged(evt);
            }
        });
        attackSliderPanel.add(attackSpinner, java.awt.BorderLayout.PAGE_START);
        attackSpinner.setBackground(new Color(65, 65, 65));

        attackLabel.setBackground(new java.awt.Color(65, 65, 65));
        attackLabel.setForeground(new java.awt.Color(255, 255, 255));
        attackLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        attackLabel.setLabelFor(attackSlider);
        attackLabel.setText("Attack");
        attackLabel.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        attackLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        attackLabel.setMinimumSize(new java.awt.Dimension(20, 26));
        attackLabel.setOpaque(true);
        attackSliderPanel.add(attackLabel, java.awt.BorderLayout.PAGE_END);

        envelopeSliders.add(attackSliderPanel);

        decaySliderPanel.setBackground(new java.awt.Color(65, 65, 65));
        decaySliderPanel.setLayout(new java.awt.BorderLayout());

        decaySlider.setBackground(new java.awt.Color(65, 65, 65));
        decaySlider.setForeground(new java.awt.Color(255, 255, 255));
        decaySlider.setMaximum(5000);
        decaySlider.setOrientation(javax.swing.JSlider.VERTICAL);
        decaySlider.setMaximumSize(new java.awt.Dimension(50, 32767));
        decaySlider.setMinimumSize(new java.awt.Dimension(20, 50));
        decaySlider.setPreferredSize(new java.awt.Dimension(50, 200));

        binding = org.jdesktop.beansbinding.Bindings.createAutoBinding(org.jdesktop.beansbinding.AutoBinding.UpdateStrategy.READ_WRITE, decaySpinner, org.jdesktop.beansbinding.ELProperty.create("${value}"), decaySlider, org.jdesktop.beansbinding.BeanProperty.create("value"));
        bindingGroup.addBinding(binding);

        decaySliderPanel.add(decaySlider, java.awt.BorderLayout.CENTER);

        decaySpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, 5000, 1));
        decaySpinner.setMinimumSize(new java.awt.Dimension(20, 26));
        decaySpinner.setPreferredSize(new java.awt.Dimension(20, 26));
        decaySpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                decaySpinnerStateChanged(evt);
            }
        });
        decaySliderPanel.add(decaySpinner, java.awt.BorderLayout.PAGE_START);
        decaySpinner.setBackground(new Color(65, 65, 65));

        decayLabel.setBackground(new java.awt.Color(65, 65, 65));
        decayLabel.setForeground(new java.awt.Color(255, 255, 255));
        decayLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        decayLabel.setLabelFor(attackSlider);
        decayLabel.setText("Decay");
        decayLabel.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        decayLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        decayLabel.setMinimumSize(new java.awt.Dimension(20, 26));
        decayLabel.setOpaque(true);
        decaySliderPanel.add(decayLabel, java.awt.BorderLayout.PAGE_END);

        envelopeSliders.add(decaySliderPanel);

        sustainSliderPanel.setBackground(new java.awt.Color(65, 65, 65));
        sustainSliderPanel.setLayout(new java.awt.BorderLayout());

        sustainSlider.setBackground(new java.awt.Color(65, 65, 65));
        sustainSlider.setForeground(new java.awt.Color(255, 255, 255));
        sustainSlider.setOrientation(javax.swing.JSlider.VERTICAL);
        sustainSlider.setMaximumSize(new java.awt.Dimension(50, 32767));
        sustainSlider.setMinimumSize(new java.awt.Dimension(20, 50));
        sustainSlider.setPreferredSize(new java.awt.Dimension(50, 200));

        binding = org.jdesktop.beansbinding.Bindings.createAutoBinding(org.jdesktop.beansbinding.AutoBinding.UpdateStrategy.READ_WRITE, sustainSpinner, org.jdesktop.beansbinding.ELProperty.create("${value}"), sustainSlider, org.jdesktop.beansbinding.BeanProperty.create("value"));
        bindingGroup.addBinding(binding);

        sustainSliderPanel.add(sustainSlider, java.awt.BorderLayout.CENTER);

        sustainSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, 100, 1));
        sustainSpinner.setMinimumSize(new java.awt.Dimension(20, 26));
        sustainSpinner.setPreferredSize(new java.awt.Dimension(20, 26));
        sustainSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sustainSpinnerStateChanged(evt);
            }
        });
        sustainSliderPanel.add(sustainSpinner, java.awt.BorderLayout.PAGE_START);
        sustainSpinner.setBackground(new Color(65, 65, 65));

        sustainLabel.setBackground(new java.awt.Color(65, 65, 65));
        sustainLabel.setForeground(new java.awt.Color(255, 255, 255));
        sustainLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        sustainLabel.setLabelFor(attackSlider);
        sustainLabel.setText("Sustain");
        sustainLabel.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        sustainLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        sustainLabel.setMinimumSize(new java.awt.Dimension(20, 26));
        sustainLabel.setOpaque(true);
        sustainSliderPanel.add(sustainLabel, java.awt.BorderLayout.PAGE_END);

        envelopeSliders.add(sustainSliderPanel);

        releaseSliderPanel.setBackground(new java.awt.Color(65, 65, 65));
        releaseSliderPanel.setLayout(new java.awt.BorderLayout());

        releaseSlider.setBackground(new java.awt.Color(65, 65, 65));
        releaseSlider.setForeground(new java.awt.Color(255, 255, 255));
        releaseSlider.setMaximum(5000);
        releaseSlider.setOrientation(javax.swing.JSlider.VERTICAL);
        releaseSlider.setMaximumSize(new java.awt.Dimension(50, 32767));
        releaseSlider.setMinimumSize(new java.awt.Dimension(20, 50));
        releaseSlider.setPreferredSize(new java.awt.Dimension(50, 200));

        binding = org.jdesktop.beansbinding.Bindings.createAutoBinding(org.jdesktop.beansbinding.AutoBinding.UpdateStrategy.READ_WRITE, releaseSpinner, org.jdesktop.beansbinding.ELProperty.create("${value}"), releaseSlider, org.jdesktop.beansbinding.BeanProperty.create("value"));
        bindingGroup.addBinding(binding);

        releaseSliderPanel.add(releaseSlider, java.awt.BorderLayout.CENTER);

        releaseSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, 5000, 1));
        releaseSpinner.setMinimumSize(new java.awt.Dimension(20, 26));
        releaseSpinner.setPreferredSize(new java.awt.Dimension(20, 26));
        releaseSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                releaseSpinnerStateChanged(evt);
            }
        });
        releaseSliderPanel.add(releaseSpinner, java.awt.BorderLayout.PAGE_START);
        releaseSpinner.setBackground(new Color(65, 65, 65));

        releaseLabel.setBackground(new java.awt.Color(65, 65, 65));
        releaseLabel.setForeground(new java.awt.Color(255, 255, 255));
        releaseLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        releaseLabel.setLabelFor(attackSlider);
        releaseLabel.setText("Release");
        releaseLabel.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        releaseLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        releaseLabel.setMinimumSize(new java.awt.Dimension(20, 26));
        releaseLabel.setOpaque(true);
        releaseSliderPanel.add(releaseLabel, java.awt.BorderLayout.PAGE_END);

        envelopeSliders.add(releaseSliderPanel);

        envelopeProperties.add(envelopeSliders);
        envelopeSliders.setBackground(new Color(65, 65, 65));

        generalProperties.add(envelopeProperties);

        timbreTitlePanel.setBackground(new java.awt.Color(65, 65, 65));
        timbreTitlePanel.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        timbreTitlePanel.setPreferredSize(new java.awt.Dimension(50, 46));
        timbreTitlePanel.setLayout(new java.awt.GridLayout());

        timbreTitle.setFont(new java.awt.Font("Lucida Grande", 1, 18)); // NOI18N
        timbreTitle.setForeground(new java.awt.Color(255, 255, 255));
        timbreTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        timbreTitle.setText("Timbre");
        timbreTitle.setToolTipText("");
        timbreTitle.setPreferredSize(new java.awt.Dimension(72, 26));
        timbreTitlePanel.add(timbreTitle);

        generalProperties.add(timbreTitlePanel);

        typeProperty.setBackground(new java.awt.Color(65, 65, 65));
        typeProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        typeProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        typeProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        typeProperty.setLayout(new java.awt.GridLayout(1, 0));

        synthRadioButton.setBackground(new java.awt.Color(65, 65, 65));
        keyTypeButtonGroup.add(synthRadioButton);
        synthRadioButton.setForeground(new java.awt.Color(255, 255, 255));
        synthRadioButton.setSelected(true);
        synthRadioButton.setText("Son");
        synthRadioButton.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                synthRadioButtonItemStateChanged(evt);
            }
        });
        typeProperty.add(synthRadioButton);

        audioClipRadioButton.setBackground(new java.awt.Color(65, 65, 65));
        keyTypeButtonGroup.add(audioClipRadioButton);
        audioClipRadioButton.setForeground(new java.awt.Color(255, 255, 255));
        audioClipRadioButton.setText("Fichier Audio");
        typeProperty.add(audioClipRadioButton);

        generalProperties.add(typeProperty);

        KeyProperties.add(generalProperties);

        noteProperties.setBackground(new java.awt.Color(65, 65, 65));
        noteProperties.setMinimumSize(new java.awt.Dimension(128, 103));
        noteProperties.setPreferredSize(new java.awt.Dimension(50, 96));
        noteProperties.setLayout(new javax.swing.BoxLayout(noteProperties, javax.swing.BoxLayout.Y_AXIS));

        frequencyProperty.setBackground(new java.awt.Color(65, 65, 65));
        frequencyProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        frequencyProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        frequencyProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        frequencyProperty.setLayout(new java.awt.GridLayout(1, 2));

        frequencyLabel.setBackground(new java.awt.Color(65, 65, 65));
        frequencyLabel.setForeground(new java.awt.Color(255, 255, 255));
        frequencyLabel.setText("Fréquence :");
        frequencyLabel.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        frequencyLabel.setOpaque(true);
        frequencyProperty.add(frequencyLabel);

        frequencySpinner.setModel(new javax.swing.SpinnerNumberModel(440.0d, 10.0d, 18000.0d, 0.1d));
        frequencySpinner.setEnabled(false);
        frequencySpinner.setMinimumSize(new java.awt.Dimension(30, 26));
        frequencyProperty.add(frequencySpinner);

        noteProperties.add(frequencyProperty);

        tuningProperty.setBackground(new java.awt.Color(65, 65, 65));
        tuningProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        tuningProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        tuningProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        tuningProperty.setLayout(new java.awt.GridLayout(1, 2));

        tuningLabel.setBackground(new java.awt.Color(65, 65, 65));
        tuningLabel.setForeground(new java.awt.Color(255, 255, 255));
        tuningLabel.setText("Tuning : ");
        tuningLabel.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        tuningLabel.setOpaque(true);
        tuningProperty.add(tuningLabel);

        tuningSpinner.setModel(new javax.swing.SpinnerNumberModel(0, -49, 49, 1));
        tuningSpinner.setMinimumSize(new java.awt.Dimension(30, 26));
        tuningSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                tuningSpinnerStateChanged(evt);
            }
        });
        tuningProperty.add(tuningSpinner);

        noteProperties.add(tuningProperty);

        waveFormProperty.setBackground(new java.awt.Color(65, 65, 65));
        waveFormProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        waveFormProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        waveFormProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        waveFormProperty.setLayout(new java.awt.GridLayout(1, 0));

        waveFormLabel.setBackground(new java.awt.Color(65, 65, 65));
        waveFormLabel.setForeground(new java.awt.Color(255, 255, 255));
        waveFormLabel.setText("Forme d'onde :");
        waveFormLabel.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        waveFormLabel.setOpaque(true);
        waveFormProperty.add(waveFormLabel);

        waveformComboBox.setMinimumSize(new java.awt.Dimension(30, 26));
        waveFormProperty.add(waveformComboBox);

        noteProperties.add(waveFormProperty);

        KeyProperties.add(noteProperties);

        audioClipProperties.setBackground(new java.awt.Color(65, 65, 65));
        audioClipProperties.setMinimumSize(new java.awt.Dimension(128, 30));
        audioClipProperties.setPreferredSize(new java.awt.Dimension(50, 70));
        audioClipProperties.setLayout(new javax.swing.BoxLayout(audioClipProperties, javax.swing.BoxLayout.Y_AXIS));

        audioClipFileProperty.setBackground(new java.awt.Color(65, 65, 65));
        audioClipFileProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        audioClipFileProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        audioClipFileProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        audioClipFileProperty.setLayout(new java.awt.GridLayout(1, 2, 10, 0));

        audioClipFileLabel.setBackground(new java.awt.Color(65, 65, 65));
        audioClipFileLabel.setForeground(new java.awt.Color(255, 255, 255));
        audioClipFileLabel.setText("Fichier :");
        audioClipFileLabel.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        audioClipFileLabel.setOpaque(true);
        audioClipFileProperty.add(audioClipFileLabel);

        audioClipPathLabel.setBackground(new java.awt.Color(65, 65, 65));
        audioClipPathLabel.setForeground(new java.awt.Color(255, 255, 255));
        audioClipPathLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        audioClipPathLabel.setText("Aucun fichier");
        audioClipPathLabel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        audioClipPathLabel.setOpaque(true);
        audioClipFileProperty.add(audioClipPathLabel);

        audioClipSelectButton.setBackground(new java.awt.Color(65, 65, 65));
        audioClipSelectButton.setForeground(new java.awt.Color(102, 102, 102));
        audioClipSelectButton.setLabel("Fichier...");
        audioClipFileProperty.add(audioClipSelectButton);

        audioClipProperties.add(audioClipFileProperty);

        readSpeedProperty.setBackground(new java.awt.Color(65, 65, 65));
        readSpeedProperty.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(65, 65, 65), 4));
        readSpeedProperty.setMinimumSize(new java.awt.Dimension(125, 32));
        readSpeedProperty.setPreferredSize(new java.awt.Dimension(50, 32));
        readSpeedProperty.setLayout(new java.awt.GridLayout(1, 2));

        readSpeedLabel.setBackground(new java.awt.Color(65, 65, 65));
        readSpeedLabel.setForeground(new java.awt.Color(255, 255, 255));
        readSpeedLabel.setText("Pitch : ");
        readSpeedLabel.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        readSpeedLabel.setOpaque(true);
        readSpeedProperty.add(readSpeedLabel);

        readSpeedSpinner.setModel(new javax.swing.SpinnerNumberModel(1.0d, 0.05d, 100.0d, 0.05d));
        readSpeedSpinner.setMinimumSize(new java.awt.Dimension(30, 26));
        readSpeedProperty.add(readSpeedSpinner);

        audioClipProperties.add(readSpeedProperty);

        KeyProperties.add(audioClipProperties);

        audioPanel.add(KeyProperties);

        tabbedPane.addTab("Audio", audioPanel);

        rightScrollPane.setViewportView(tabbedPane);
        tabbedPane.getAccessibleContext().setAccessibleName("Forme");

        splitWindow.setRightComponent(rightScrollPane);

        getContentPane().add(splitWindow, java.awt.BorderLayout.CENTER);

        jToolBar1.setBackground(new java.awt.Color(51, 51, 51));
        jToolBar1.setBorder(null);
        jToolBar1.setFloatable(false);
        jToolBar1.setRollover(true);

        buttonPlayMode.setBackground(new java.awt.Color(65, 65, 65));
        buttonPlayMode.setForeground(new java.awt.Color(0, 0, 255));
        buttonPlayMode.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnPlay.png"))); // NOI18N
        buttonPlayMode.setToolTipText("Mode Jeu Libre");
        buttonPlayMode.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonPlayMode.setBorderPainted(false);
        buttonPlayMode.setFocusable(false);
        buttonPlayMode.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonPlayMode.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonPlayMode.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonPlayModeActionPerformed(evt);
            }
        });
        jToolBar1.add(buttonPlayMode);

        buttonEditKey.setBackground(new java.awt.Color(65, 65, 65));
        buttonEditKey.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnEdit.png"))); // NOI18N
        buttonEditKey.setToolTipText("Mode Édition");
        buttonEditKey.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonEditKey.setBorderPainted(false);
        buttonEditKey.setFocusable(false);
        buttonEditKey.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonEditKey.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonEditKey.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonEditKeyActionPerformed(evt);
            }
        });
        jToolBar1.add(buttonEditKey);
        jToolBar1.add(filler7);

        selectedKeyTools.setOpaque(false);
        selectedKeyTools.setLayout(new javax.swing.BoxLayout(selectedKeyTools, javax.swing.BoxLayout.LINE_AXIS));

        buttonDuplicate.setBackground(new java.awt.Color(65, 65, 65));
        buttonDuplicate.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnDuplicate.png"))); // NOI18N
        buttonDuplicate.setToolTipText("Dupliquer la touche");
        buttonDuplicate.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonDuplicate.setBorderPainted(false);
        buttonDuplicate.setFocusable(false);
        buttonDuplicate.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonDuplicate.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonDuplicate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonDuplicateActionPerformed(evt);
            }
        });
        selectedKeyTools.add(buttonDuplicate);

        buttonAddImage.setBackground(new java.awt.Color(65, 65, 65));
        buttonAddImage.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnAddImage.png"))); // NOI18N
        buttonAddImage.setToolTipText("Ajouter une image");
        buttonAddImage.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonAddImage.setBorderPainted(false);
        buttonAddImage.setFocusable(false);
        buttonAddImage.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonAddImage.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonAddImage.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonAddImageActionPerformed(evt);
            }
        });
        selectedKeyTools.add(buttonAddImage);

        buttonRemoveImage.setBackground(new java.awt.Color(65, 65, 65));
        buttonRemoveImage.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnDeleteImage.png"))); // NOI18N
        buttonRemoveImage.setToolTipText("Supprimer l'image");
        buttonRemoveImage.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonRemoveImage.setBorderPainted(false);
        buttonRemoveImage.setFocusable(false);
        buttonRemoveImage.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonRemoveImage.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonRemoveImage.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonRemoveImageActionPerformed(evt);
            }
        });
        selectedKeyTools.add(buttonRemoveImage);

        buttonAddSunkenImage.setBackground(new java.awt.Color(65, 65, 65));
        buttonAddSunkenImage.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnAddSunkenImage.png"))); // NOI18N
        buttonAddSunkenImage.setToolTipText("Ajouter une image pour l'état enfoncée");
        buttonAddSunkenImage.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonAddSunkenImage.setBorderPainted(false);
        buttonAddSunkenImage.setFocusable(false);
        buttonAddSunkenImage.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonAddSunkenImage.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonAddSunkenImage.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonAddSunkenImageActionPerformed(evt);
            }
        });
        selectedKeyTools.add(buttonAddSunkenImage);

        buttonRemoveSunkenImage.setBackground(new java.awt.Color(65, 65, 65));
        buttonRemoveSunkenImage.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnDeleteSunkenImage.png"))); // NOI18N
        buttonRemoveSunkenImage.setToolTipText("Supprimer l'image pour l'état enfoncée");
        buttonRemoveSunkenImage.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonRemoveSunkenImage.setBorderPainted(false);
        buttonRemoveSunkenImage.setFocusable(false);
        buttonRemoveSunkenImage.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonRemoveSunkenImage.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonRemoveSunkenImage.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonRemoveSunkenImageActionPerformed(evt);
            }
        });
        selectedKeyTools.add(buttonRemoveSunkenImage);

        buttonDelete.setBackground(new java.awt.Color(65, 65, 65));
        buttonDelete.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnDelete.png"))); // NOI18N
        buttonDelete.setToolTipText("Supprimer la touche");
        buttonDelete.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 5));
        buttonDelete.setBorderPainted(false);
        buttonDelete.setFocusable(false);
        buttonDelete.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        buttonDelete.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        buttonDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonDeleteActionPerformed(evt);
            }
        });
        selectedKeyTools.add(buttonDelete);

        jToolBar1.add(selectedKeyTools);

        getContentPane().add(jToolBar1, java.awt.BorderLayout.PAGE_START);

        fileMenuItem.setBorder(null);
        fileMenuItem.setText("Fichier");

        newMenu.setBorder(null);
        newMenu.setText("Nouveau");

        newBlankMenuItem.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_N, java.awt.event.InputEvent.CTRL_MASK));
        newBlankMenuItem.setText("Vide");
        newBlankMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                newBlankMenuItemActionPerformed(evt);
            }
        });
        newMenu.add(newBlankMenuItem);

        newGuitarMenuItem.setText("Guitare");
        newGuitarMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                newGuitarMenuItemActionPerformed(evt);
            }
        });
        newMenu.add(newGuitarMenuItem);

        fileMenuItem.add(newMenu);

        openMenuItem.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_O, java.awt.event.InputEvent.CTRL_MASK));
        openMenuItem.setText("Ouvrir");
        openMenuItem.setBorder(null);
        openMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                openMenuItemActionPerformed(evt);
            }
        });
        fileMenuItem.add(openMenuItem);

        saveMenuItem.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_S, java.awt.event.InputEvent.CTRL_MASK));
        saveMenuItem.setText("Enregistrer");
        saveMenuItem.setBorder(null);
        saveMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                saveMenuItemActionPerformed(evt);
            }
        });
        fileMenuItem.add(saveMenuItem);

        saveAsMenuItem.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_S, java.awt.event.InputEvent.SHIFT_MASK | java.awt.event.InputEvent.CTRL_MASK));
        saveAsMenuItem.setText("Enregistrer sous");
        saveAsMenuItem.setBorder(null);
        saveAsMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                saveAsMenuItemActionPerformed(evt);
            }
        });
        fileMenuItem.add(saveAsMenuItem);

        quitMenuItem.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_Q, java.awt.event.InputEvent.CTRL_MASK));
        quitMenuItem.setText("Quitter");
        quitMenuItem.setBorder(null);
        quitMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                quitMenuItemActionPerformed(evt);
            }
        });
        fileMenuItem.add(quitMenuItem);

        jMenuBar1.add(fileMenuItem);

        insertMenuItem.setBorder(null);
        insertMenuItem.setText("Insérer");

        createRectangleMenuItem.setText("Rectangle");
        createRectangleMenuItem.setBorder(null);
        createRectangleMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                createRectangleMenuItemActionPerformed(evt);
            }
        });
        insertMenuItem.add(createRectangleMenuItem);

        createTriangleMenuItem.setText("Triangle");
        createTriangleMenuItem.setBorder(null);
        createTriangleMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                createTriangleMenuItemActionPerformed(evt);
            }
        });
        insertMenuItem.add(createTriangleMenuItem);

        jMenuBar1.add(insertMenuItem);

        setJMenuBar(jMenuBar1);

        bindingGroup.bind();

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void newBlankMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_newBlankMenuItemActionPerformed
        GaudrophoneController.getController().getInstrumentManager().newInstrument();
        this.refresh();
    }//GEN-LAST:event_newBlankMenuItemActionPerformed

    private void newGuitarMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_newGuitarMenuItemActionPerformed
        GaudrophoneController.getController().getInstrumentManager().newInstrument(new Guitar());
        this.refresh();
    }//GEN-LAST:event_newGuitarMenuItemActionPerformed

    private void quitMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_quitMenuItemActionPerformed
        System.exit(0);
    }//GEN-LAST:event_quitMenuItemActionPerformed

    private void openMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_openMenuItemActionPerformed
        fileDialog.setDialogTitle("Sélectionner un fichier");
        FileFilter filter = new FileNameExtensionFilter("Fichier Gaudrophone","gaud");
        fileDialog.resetChoosableFileFilters();
        fileDialog.setFileFilter(filter);
        fileDialog.setFileSelectionMode(JFileChooser.FILES_ONLY);
        
        if (fileDialog.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
            if (GaudrophoneController.getController().getInstrumentManager().openInstrument(fileDialog.getSelectedFile().getAbsolutePath())) {
                this.refresh();
            } else {
                javax.swing.JOptionPane.showMessageDialog(null, "Impossible d'ouvrir cet instrument");
            }
        }
    }//GEN-LAST:event_openMenuItemActionPerformed

    private void saveMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_saveMenuItemActionPerformed
        if (!GaudrophoneController.getController().getInstrumentManager().saveInstrument()) {
            saveInstrument();
        }
    }//GEN-LAST:event_saveMenuItemActionPerformed

    private void saveAsMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_saveAsMenuItemActionPerformed
        saveInstrument();
    }//GEN-LAST:event_saveAsMenuItemActionPerformed

    private void createRectangleMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_createRectangleMenuItemActionPerformed
        this.resetButtons();
        GaudrophoneController.getController().getCanvasManager().setState(State.CreatingShape);
        GaudrophoneController.getController().getCanvasManager().setStoredKeyGenerator(new RectangleKeyShape());
    }//GEN-LAST:event_createRectangleMenuItemActionPerformed

    private void createTriangleMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_createTriangleMenuItemActionPerformed
        this.resetButtons();
        GaudrophoneController.getController().getCanvasManager().setState(State.CreatingShape);
        GaudrophoneController.getController().getCanvasManager().setStoredKeyGenerator(new TriangleKeyShape());
    }//GEN-LAST:event_createTriangleMenuItemActionPerformed

    private void buttonPlayModeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonPlayModeActionPerformed
        GaudrophoneController.getController().getCanvasManager().setState(State.Play);
        this.resetButtons();
        buttonPlayMode.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnPlay_selected.png")));
    }//GEN-LAST:event_buttonPlayModeActionPerformed

    private void buttonEditKeyActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonEditKeyActionPerformed
        GaudrophoneController.getController().getCanvasManager().setState(State.EditKey);
        this.resetButtons();
        buttonEditKey.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnEdit_selected.png")));
    }//GEN-LAST:event_buttonEditKeyActionPerformed

    private void keyNameFieldKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_keyNameFieldKeyReleased
        GaudrophoneController.getController().setName(keyNameField.getText());
    }//GEN-LAST:event_keyNameFieldKeyReleased

    private void attackSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_attackSpinnerStateChanged
        GaudrophoneController.getController().setAttack((double)attackSlider.getValue());
    }//GEN-LAST:event_attackSpinnerStateChanged

    private void decaySpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_decaySpinnerStateChanged
        GaudrophoneController.getController().setDecay((double)decaySlider.getValue());
    }//GEN-LAST:event_decaySpinnerStateChanged

    private void sustainSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_sustainSpinnerStateChanged
        GaudrophoneController.getController().setSustain((double)sustainSlider.getValue());
    }//GEN-LAST:event_sustainSpinnerStateChanged

    private void releaseSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_releaseSpinnerStateChanged
        GaudrophoneController.getController().setRelease((double)releaseSlider.getValue());
    }//GEN-LAST:event_releaseSpinnerStateChanged

    private void synthRadioButtonItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_synthRadioButtonItemStateChanged
        this.noteProperties.setVisible(evt.getStateChange() == ItemEvent.SELECTED);
        this.audioClipProperties.setVisible(evt.getStateChange() == ItemEvent.DESELECTED);
    }//GEN-LAST:event_synthRadioButtonItemStateChanged

    private void buttonDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonDeleteActionPerformed
        GaudrophoneController.getController().deleteKey();
    }//GEN-LAST:event_buttonDeleteActionPerformed

    private void buttonDuplicateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonDuplicateActionPerformed
        GaudrophoneController.getController().duplicateKey();
    }//GEN-LAST:event_buttonDuplicateActionPerformed

    private void volumeSliderStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_volumeSliderStateChanged
        GaudrophoneController.getController().setVolume((double)volumeSlider.getValue()/100);
    }//GEN-LAST:event_volumeSliderStateChanged

    private void displayNameCheckBoxItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_displayNameCheckBoxItemStateChanged
        if(evt.getStateChange() == ItemEvent.SELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().addState(KeyState.displayName);
            canvas.repaint();
        } else if(evt.getStateChange() == ItemEvent.DESELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().removeState(KeyState.displayName);
            canvas.repaint();
        }
    }//GEN-LAST:event_displayNameCheckBoxItemStateChanged

    private void displayNoteCheckBoxItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_displayNoteCheckBoxItemStateChanged
        if(evt.getStateChange() == ItemEvent.SELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().addState(KeyState.displayNote);
            canvas.repaint();
        } else if(evt.getStateChange() == ItemEvent.DESELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().removeState(KeyState.displayNote);
            canvas.repaint();
        }
    }//GEN-LAST:event_displayNoteCheckBoxItemStateChanged

    private void displayOctaveCheckBoxItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_displayOctaveCheckBoxItemStateChanged
        if(evt.getStateChange() == ItemEvent.SELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().addState(KeyState.displayOctave);
            canvas.repaint();
        } else if(evt.getStateChange() == ItemEvent.DESELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().removeState(KeyState.displayOctave);
            canvas.repaint();
        }
    }//GEN-LAST:event_displayOctaveCheckBoxItemStateChanged

    private void displayAlterationCheckBoxItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_displayAlterationCheckBoxItemStateChanged
        if(evt.getStateChange() == ItemEvent.SELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().addState(KeyState.displayAlteration);
            canvas.repaint();
        } else if(evt.getStateChange() == ItemEvent.DESELECTED) {
            GaudrophoneController.getController().getSelectionManager().getSelectedKey().removeState(KeyState.displayAlteration);
            canvas.repaint();
        }
    }//GEN-LAST:event_displayAlterationCheckBoxItemStateChanged
    
    
    private void buttonRemoveImageActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonRemoveImageActionPerformed
        GaudrophoneController.getController().setKeyImage(null);
        this.buttonRemoveImage.setVisible(false);
        this.buttonAddImage.setVisible(true);
    }//GEN-LAST:event_buttonRemoveImageActionPerformed
    
    private void buttonRemoveSunkenImageActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonRemoveSunkenImageActionPerformed
        GaudrophoneController.getController().setKeySunkenImage(null);
        this.buttonRemoveSunkenImage.setVisible(false);
        this.buttonAddSunkenImage.setVisible(true);
    }//GEN-LAST:event_buttonRemoveSunkenImageActionPerformed

    private void buttonAddImageActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonAddImageActionPerformed
        fileDialog.setDialogTitle("Sélectionner une image");
        fileDialog.resetChoosableFileFilters();
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier JPEG","jpg"));
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier PNG","png"));
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier GIF","gif"));
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier Bitmap","bmp"));
        fileDialog.setFileSelectionMode(JFileChooser.FILES_ONLY);
        
        if (fileDialog.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
            GaudrophoneController.getController().setKeyImage(fileDialog.getSelectedFile().getAbsolutePath());
            this.buttonRemoveImage.setVisible(true);
            this.buttonAddImage.setVisible(false);
        }
    }//GEN-LAST:event_buttonAddImageActionPerformed

    private void buttonAddSunkenImageActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonAddSunkenImageActionPerformed
        fileDialog.setDialogTitle("Sélectionner une image");
        fileDialog.resetChoosableFileFilters();
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier JPEG","jpg"));
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier PNG","png"));
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier GIF","gif"));
        fileDialog.addChoosableFileFilter(new FileNameExtensionFilter("Fichier Bitmap","bmp"));
        fileDialog.setFileSelectionMode(JFileChooser.FILES_ONLY);
        
        if (fileDialog.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
            GaudrophoneController.getController().setKeySunkenImage(fileDialog.getSelectedFile().getAbsolutePath());
            this.buttonRemoveSunkenImage.setVisible(true);
            this.buttonAddSunkenImage.setVisible(false);
        }
    }//GEN-LAST:event_buttonAddSunkenImageActionPerformed

    private void backgroundDisplayLabelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_backgroundDisplayLabelMouseClicked
        Color color = JColorChooser.showDialog(this, "Choisir une couleur", backgroundDisplayLabel.getBackground());
        if (color != null) {
            GaudrophoneController.getController().setKeyColor(color);
            this.backgroundDisplayLabel.setBackground(color);
        }
    }//GEN-LAST:event_backgroundDisplayLabelMouseClicked

    private void backgroundSunkenDisplayLabelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_backgroundSunkenDisplayLabelMouseClicked
        Color color = JColorChooser.showDialog(this, "Choisir une couleur", backgroundSunkenDisplayLabel.getBackground());
        if (color != null) {
            GaudrophoneController.getController().setKeySunkenColor(color);
            this.backgroundSunkenDisplayLabel.setBackground(color);
        }
    }//GEN-LAST:event_backgroundSunkenDisplayLabelMouseClicked

    private void octaveSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_octaveSpinnerStateChanged
        GaudrophoneController.getController().setOctave((int)this.octaveSpinner.getValue());
    }//GEN-LAST:event_octaveSpinnerStateChanged

    private void flatRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_flatRadioButtonActionPerformed
        GaudrophoneController.getController().setAlteration(Alteration.Flat);
    }//GEN-LAST:event_flatRadioButtonActionPerformed

    private void naturalRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_naturalRadioButtonActionPerformed
        GaudrophoneController.getController().setAlteration(Alteration.Natural);
    }//GEN-LAST:event_naturalRadioButtonActionPerformed

    private void sharpRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_sharpRadioButtonActionPerformed
        GaudrophoneController.getController().setAlteration(Alteration.Sharp);
    }//GEN-LAST:event_sharpRadioButtonActionPerformed

    private void tuningSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_tuningSpinnerStateChanged
        GaudrophoneController.getController().setTuning((int)this.tuningSpinner.getValue());
    }//GEN-LAST:event_tuningSpinnerStateChanged

    private void textColorDisplayLabelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_textColorDisplayLabelMouseClicked
        Color color = JColorChooser.showDialog(this, "Choisir une couleur", textColorDisplayLabel.getBackground());
        if (color != null) {
            GaudrophoneController.getController().setKeyTextColor(color);
            this.textColorDisplayLabel.setBackground(color);
        }
    }//GEN-LAST:event_textColorDisplayLabelMouseClicked

    private void textSunkenColorDisplayLabelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_textSunkenColorDisplayLabelMouseClicked
        Color color = JColorChooser.showDialog(this, "Choisir une couleur", textSunkenColorDisplayLabel.getBackground());
        if (color != null) {
            GaudrophoneController.getController().setKeySunkenTextColor(color);
            this.textSunkenColorDisplayLabel.setBackground(color);
        }
    }//GEN-LAST:event_textSunkenColorDisplayLabelMouseClicked

    private void outlineDisplayLabel1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_outlineDisplayLabel1MouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_outlineDisplayLabel1MouseClicked
    
    private void resetButtons() {
        if (this.splitWindow.getRightComponent() != null) {
            this.splitWindow.setRightComponent(null);
        }
        buttonPlayMode.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnPlay.png")));
        buttonEditKey.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/btnEdit.png")));
    }
    
    private void saveInstrument() {
        fileDialog.setDialogTitle("Sélectionner un emplacement");
        FileFilter filter = new FileNameExtensionFilter("Fichier Gaudrophone","gaud");
        fileDialog.resetChoosableFileFilters();
        fileDialog.setFileFilter(filter);
        fileDialog.setFileSelectionMode(JFileChooser.FILES_ONLY);

        if (fileDialog.showSaveDialog(this) == JFileChooser.APPROVE_OPTION) {
            String filepath = fileDialog.getSelectedFile().getAbsolutePath();
            if (!filepath.endsWith(".gaud")) {
                filepath += ".gaud";
            }
            GaudrophoneController.getController().getInstrumentManager().saveInstrument(filepath);
        }
    }
    
    private void refresh() {
        GaudrophoneController.getController().getCanvasManager().drawKeys(GaudrophoneController.getController().getInstrumentManager().getInstrument().getKeys());
    }
    
    private void hideControls() {
        if (this.splitWindow.getRightComponent() != null) {
            this.splitWindow.setRightComponent(null);
        }
        this.selectedKeyTools.setVisible(false);
        this.buttonAddImage.setVisible(false);
        this.buttonAddSunkenImage.setVisible(false);
        this.buttonRemoveImage.setVisible(false);
        this.buttonRemoveSunkenImage.setVisible(false);
    }
    
    public void setVisible() {
        java.awt.EventQueue.invokeLater(() -> {
            this.splitWindow.setLeftComponent(this.canvas);
            this.hideControls();
            this.setVisible(true);
            this.setFocusable(true);
            this.requestFocusInWindow();
            
            this.canvas.setBackground(new Color(102,102,102));
            this.canvas.addMouseListener(new java.awt.event.MouseAdapter() {
                @Override
                public void mousePressed(java.awt.event.MouseEvent e) {
                    refresh();
                }

                @Override
                public void mouseReleased(java.awt.event.MouseEvent e) {
                    refresh();
                }
            });
            
            this.addKeyListener(new java.awt.event.KeyAdapter() {
                @Override
                public void keyPressed(java.awt.event.KeyEvent e) {
                    if(e.getKeyCode() == KeyEvent.VK_DELETE &&
                            (GaudrophoneController.getController().getCanvasManager().getState() == Manager.State.EditKey ||
                            GaudrophoneController.getController().getCanvasManager().getState() == Manager.State.EditLine ||
                            GaudrophoneController.getController().getCanvasManager().getState() == Manager.State.EditPoint))
                        GaudrophoneController.getController().deleteKey();
                }
            });
            
            this.canvas.addComponentListener(new java.awt.event.ComponentAdapter() {
                @Override
                public void componentResized(ComponentEvent e) {
                    GaudrophoneController.getController().getCanvasManager().setCanvasSize(e.getComponent().getWidth(), e.getComponent().getHeight());
                    refresh();
                }
            });
            
            this.noteComboBox.addActionListener((ActionEvent e) -> {
                GaudrophoneController.getController().setNote((Note)this.noteComboBox.getSelectedItem());
            });
            
            this.waveformComboBox.addActionListener((ActionEvent e) -> {
                GaudrophoneController.getController().setWaveform((WaveFormType)this.waveformComboBox.getSelectedItem());
            });
            
            GaudrophoneController.getController().getCanvasManager().setCanvasSize(this.canvasPannel.getWidth(), this.canvasPannel.getHeight());
            GaudrophoneController.getController().delegate = this;
            GaudrophoneController.getController().getSelectionManager().delegate = this;
            GaudrophoneController.getController().getCanvasManager().delegate = this;
            
            GaudrophoneController.getController().getInstrumentManager().newInstrument();
            
            
//            MINI-PIANO
            Key key = new Key(new SynthesizedSound(440), new RectangleKeyShape().generateSquare(50, new Vector2(2, 2)), "A");
            key.getShape().getIdleAppearance().setColor(Color.yellow);
            GaudrophoneController.getController().getInstrumentManager().getInstrument().addKey(key);

            Key key1 = new Key(new SynthesizedSound(493.88), new RectangleKeyShape().generateSquare(50, new Vector2(52, 2)), "B");
            key1.getShape().getIdleAppearance().setColor(Color.PINK);
            GaudrophoneController.getController().getInstrumentManager().getInstrument().addKey(key1);

            Key key2 = new Key(new SynthesizedSound(523.25), new RectangleKeyShape().generateSquare(50, new Vector2(104, 2)), "C");
            key2.getShape().getIdleAppearance().setColor(Color.CYAN);
            GaudrophoneController.getController().getInstrumentManager().getInstrument().addKey(key2);

            Key key3 = new Key(new SynthesizedSound(587.33), new RectangleKeyShape().generateSquare(50, new Vector2(156, 2)), "D");
            key3.getShape().getIdleAppearance().setColor(Color.MAGENTA);
            GaudrophoneController.getController().getInstrumentManager().getInstrument().addKey(key3);

            Sound sound = new SynthesizedSound(659.25);
            Key key4 = new Key(sound, new RectangleKeyShape().generateSquare(50, new Vector2(208, 2)), "E");
            key4.getShape().getIdleAppearance().setColor(Color.green);
            GaudrophoneController.getController().getInstrumentManager().getInstrument().addKey(key4);

            this.refresh();
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel KeyProperties;
    private javax.swing.ButtonGroup alterationButtonGroup;
    private javax.swing.JLabel alterationLabel;
    private javax.swing.JPanel alterationProperty;
    private javax.swing.JLabel attackLabel;
    private javax.swing.JSlider attackSlider;
    private javax.swing.JPanel attackSliderPanel;
    private javax.swing.JSpinner attackSpinner;
    private javax.swing.JLabel audioClipFileLabel;
    private javax.swing.JPanel audioClipFileProperty;
    private javax.swing.JLabel audioClipPathLabel;
    private javax.swing.JPanel audioClipProperties;
    private javax.swing.JRadioButton audioClipRadioButton;
    private java.awt.Button audioClipSelectButton;
    private javax.swing.JPanel audioPanel;
    private javax.swing.JLabel backgroundDisplayLabel;
    private javax.swing.JLabel backgroundLabel;
    private javax.swing.JPanel backgroundSpacer;
    private javax.swing.JLabel backgroundSunkenDisplayLabel;
    private javax.swing.JLabel backgroundSunkenLabel;
    private javax.swing.JPanel borderPanel;
    private javax.swing.JPanel borderSpacer1;
    private javax.swing.JLabel borderTitle;
    private javax.swing.JPanel borderWrapper;
    private javax.swing.JButton buttonAddImage;
    private javax.swing.JButton buttonAddSunkenImage;
    private javax.swing.JButton buttonDelete;
    private javax.swing.JButton buttonDuplicate;
    private javax.swing.JButton buttonEditKey;
    private javax.swing.JButton buttonPlayMode;
    private javax.swing.JButton buttonRemoveImage;
    private javax.swing.JButton buttonRemoveSunkenImage;
    private javax.swing.Box.Filler canvasPannel;
    private javax.swing.JLabel colorTitle;
    private javax.swing.JPanel colorWrapper;
    private javax.swing.JPanel colorsPanel;
    private javax.swing.JMenuItem createRectangleMenuItem;
    private javax.swing.JMenuItem createTriangleMenuItem;
    private javax.swing.JLabel decayLabel;
    private javax.swing.JSlider decaySlider;
    private javax.swing.JPanel decaySliderPanel;
    private javax.swing.JSpinner decaySpinner;
    private javax.swing.JCheckBox displayAlterationCheckBox;
    private javax.swing.JCheckBox displayNameCheckBox;
    private javax.swing.JCheckBox displayNoteCheckBox;
    private javax.swing.JCheckBox displayOctaveCheckBox;
    private javax.swing.JPanel envelopeGraph;
    private javax.swing.JLabel envelopeLabel;
    private javax.swing.JPanel envelopeProperties;
    private javax.swing.JPanel envelopeSliders;
    private javax.swing.JPanel envelopeTitlePanel;
    private javax.swing.JFileChooser fileDialog;
    private javax.swing.JMenu fileMenuItem;
    private javax.swing.Box.Filler filler10;
    private javax.swing.Box.Filler filler11;
    private javax.swing.Box.Filler filler12;
    private javax.swing.Box.Filler filler13;
    private javax.swing.Box.Filler filler14;
    private javax.swing.Box.Filler filler15;
    private javax.swing.Box.Filler filler2;
    private javax.swing.Box.Filler filler3;
    private javax.swing.Box.Filler filler4;
    private javax.swing.Box.Filler filler5;
    private javax.swing.Box.Filler filler6;
    private javax.swing.Box.Filler filler7;
    private javax.swing.JRadioButton flatRadioButton;
    private javax.swing.JLabel frequencyLabel;
    private javax.swing.JPanel frequencyProperty;
    private javax.swing.JSpinner frequencySpinner;
    private javax.swing.JPanel generalProperties;
    private javax.swing.JLabel hauteurTitle;
    private javax.swing.JPanel hauteurTitlePanel;
    private javax.swing.JLabel informationTitle;
    private javax.swing.JPanel informationWrapper;
    private javax.swing.JMenu insertMenuItem;
    private javax.swing.JPanel instrumentPanel;
    private javax.swing.JComboBox<String> jComboBox1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JSpinner jSpinner1;
    private javax.swing.JToolBar jToolBar1;
    private javax.swing.JTextField keyNameField;
    private javax.swing.JLabel keyNameLabel;
    private javax.swing.JPanel keyNameProperty;
    private javax.swing.ButtonGroup keyTypeButtonGroup;
    private javax.swing.JPanel lineControlWrapper;
    private javax.swing.JPanel linesSelectionWrapper;
    private javax.swing.JPanel linesWrapper;
    private javax.swing.JRadioButton naturalRadioButton;
    private javax.swing.JMenuItem newBlankMenuItem;
    private javax.swing.JMenuItem newGuitarMenuItem;
    private javax.swing.JMenu newMenu;
    private javax.swing.JPanel normalProperty;
    private javax.swing.JLabel normalTitle;
    private javax.swing.JPanel normalWrapper;
    private javax.swing.JComboBox<String> noteComboBox;
    private javax.swing.JLabel noteNameLabel;
    private javax.swing.JPanel noteNameProperty;
    private javax.swing.JPanel noteProperties;
    private javax.swing.JLabel octaveLabel;
    private javax.swing.JSpinner octaveSpinner;
    private javax.swing.JMenuItem openMenuItem;
    private javax.swing.JLabel outlineDisplayLabel1;
    private javax.swing.JMenuItem quitMenuItem;
    private javax.swing.JLabel readSpeedLabel;
    private javax.swing.JPanel readSpeedProperty;
    private javax.swing.JSpinner readSpeedSpinner;
    private javax.swing.JLabel releaseLabel;
    private javax.swing.JSlider releaseSlider;
    private javax.swing.JPanel releaseSliderPanel;
    private javax.swing.JSpinner releaseSpinner;
    private javax.swing.JScrollPane rightScrollPane;
    private javax.swing.JMenuItem saveAsMenuItem;
    private javax.swing.JMenuItem saveMenuItem;
    private javax.swing.JPanel selectedKeyTools;
    private javax.swing.JRadioButton sharpRadioButton;
    private javax.swing.JPanel showNameProperty;
    private javax.swing.JLabel showNoteNameLabel;
    private javax.swing.JSplitPane splitWindow;
    private javax.swing.JPanel sunkenProperty;
    private javax.swing.JPanel sunkenSpacer;
    private javax.swing.JLabel sunkenTitle;
    private javax.swing.JPanel sunkenWrapper;
    private javax.swing.JLabel sustainLabel;
    private javax.swing.JSlider sustainSlider;
    private javax.swing.JPanel sustainSliderPanel;
    private javax.swing.JSpinner sustainSpinner;
    private javax.swing.JRadioButton synthRadioButton;
    private javax.swing.JTabbedPane tabbedPane;
    private javax.swing.JLabel textColorDisplayLabel;
    private javax.swing.JLabel textColorInfoLabel;
    private javax.swing.JPanel textColorSpacer;
    private javax.swing.JLabel textSunkenColorDisplayLabel;
    private javax.swing.JLabel textSunkenColorLabel;
    private javax.swing.JPanel textSunkenColorSpacer;
    private javax.swing.JLabel timbreTitle;
    private javax.swing.JPanel timbreTitlePanel;
    private javax.swing.JLabel tuningLabel;
    private javax.swing.JPanel tuningProperty;
    private javax.swing.JSpinner tuningSpinner;
    private javax.swing.JPanel typeProperty;
    private javax.swing.JPanel visualPanel;
    private javax.swing.JPanel visualWrapper;
    private javax.swing.JLabel volumeLabel;
    private javax.swing.JPanel volumeProperty;
    private javax.swing.JSlider volumeSlider;
    private javax.swing.JSpinner volumeSpinner;
    private javax.swing.JLabel waveFormLabel;
    private javax.swing.JPanel waveFormProperty;
    private javax.swing.JComboBox<String> waveformComboBox;
    private org.jdesktop.beansbinding.BindingGroup bindingGroup;
    // End of variables declaration//GEN-END:variables

    @Override
    public void didSelectKey(Key key) {
        this.keyNameField.setText(key.getName());
        this.noteComboBox.setSelectedItem(key.getNote());
        this.octaveSpinner.setValue(key.getOctave());
        this.volumeSpinner.setValue((int)(key.getSound().getVolume()*100));
        
        switch (key.getAlteration()) {
            case Natural:
                this.naturalRadioButton.setSelected(true);
                break;
            case Sharp:
                this.sharpRadioButton.setSelected(true);
                break;
            case Flat:
                this.flatRadioButton.setSelected(true);
                break;
        }
        
        this.attackSpinner.setValue(key.getSound().getEnvelope().getAttack());
        this.decaySpinner.setValue(key.getSound().getEnvelope().getDecay());
        this.sustainSpinner.setValue(key.getSound().getEnvelope().getSustain());
        this.releaseSpinner.setValue(key.getSound().getEnvelope().getRelease());
        
        this.displayNameCheckBox.setSelected((key.getStates() & KeyState.displayName.getValue()) != 0);
        this.displayNoteCheckBox.setSelected((key.getStates() & KeyState.displayNote.getValue()) != 0);
        this.displayOctaveCheckBox.setSelected((key.getStates() & KeyState.displayOctave.getValue()) != 0);
        this.displayAlterationCheckBox.setSelected((key.getStates() & KeyState.displayAlteration.getValue()) != 0);
        
        if (key.getSound().getType() == SoundType.synthesizedSound) {
            SynthesizedSound sound = (SynthesizedSound)key.getSound();
            this.tuningSpinner.setValue(sound.getTuning());
            this.frequencySpinner.setValue(sound.getFrequency());
            this.waveformComboBox.setSelectedItem(sound.getWaveform());
        }
        
        this.backgroundDisplayLabel.setBackground(key.getShape().getIdleAppearance().getColor());
        this.backgroundSunkenDisplayLabel.setBackground(key.getShape().getSunkenAppearance().getColor());
        this.textColorDisplayLabel.setBackground(key.getShape().getIdleAppearance().getTextColor());
        this.textSunkenColorDisplayLabel.setBackground(key.getShape().getSunkenAppearance().getTextColor());
        
        this.selectedKeyTools.setVisible(true);
        this.buttonAddImage.setVisible(key.getShape().getIdleAppearance().getImagePath() == null);
        this.buttonAddSunkenImage.setVisible(key.getShape().getSunkenAppearance().getImagePath() == null);
        this.buttonRemoveImage.setVisible(key.getShape().getIdleAppearance().getImagePath() != null);
        this.buttonRemoveSunkenImage.setVisible(key.getShape().getSunkenAppearance().getImagePath() != null);
        
        if (this.splitWindow.getRightComponent() == null) {
            this.splitWindow.setRightComponent(this.rightScrollPane);
            this.splitWindow.setDividerLocation(Math.max(this.splitWindow.getWidth()/2, this.splitWindow.getWidth()-500));
        }
    }
    
    @Override
    public void didDeselectKey() {
        this.keyNameField.setText("Nom de la touche");
        
        this.hideControls();
    }

    @Override
    public void shouldRedraw() {
        this.canvas.repaint();
    }

    @Override
    public void shouldUpdateProprietyPannelFor(Key key) {
        this.didSelectKey(key);
    }
}
